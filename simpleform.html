<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resume Builder</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background:linear-gradient(135deg,#ff9a9e,#fad0c4,#a1c4fd,#c2e9fb);
    background-size:400% 400%;
    animation:bgMove 10s ease infinite;
}

@keyframes bgMove{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
}

.container{
    max-width:900px;
    margin:30px auto;
    padding:25px;
    background:#fff;
    border-radius:20px;
    box-shadow:0 15px 35px rgba(0,0,0,.25);
}

h1{
    text-align:center;
    background:linear-gradient(90deg,#ff4081,#7c4dff,#00e5ff);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

label{font-weight:600;margin-top:12px;display:block}

input,textarea{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid #ccc;
    margin-bottom:10px;
}

button{
    padding:12px 22px;
    border:none;
    border-radius:30px;
    cursor:pointer;
    font-weight:600;
    margin-right:10px;
}

.preview-btn{background:#ff4081;color:#fff}
.add-btn{background:#00c853;color:#fff}
.remove-btn{background:#f44336;color:#fff}
.download-btn{background:#2196f3;color:#fff}
</style>
</head>

<body>

<div class="container">
<h1>üå∏ Resume Builder üå∏</h1>

<label>Upload Photo</label>
<input type="file" id="photo">

<label>Full Name</label>
<input id="fullName">

<label>Date of Birth</label>
<input id="dob" type="date">

<label>Email</label>
<input id="email">

<label>Phone</label>
<input id="phone">

<label>Address</label>
<textarea id="address"></textarea>

<label>Career Objective</label>
<textarea id="objective"></textarea>

<label>Professional Summary</label>
<textarea id="summary"></textarea>

<label>Academic Details</label>
<div id="academicsContainer">
<div class="academicRow" style="display:flex;gap:5px">
<input placeholder="Course">
<input placeholder="Institute">
<input placeholder="Year">
<input placeholder="GPA">
<button class="remove-btn" onclick="removeAcademic(this)">‚úñ</button>
</div>
</div>

<button class="add-btn" onclick="addAcademic()">‚ûï Add Academic</button>

<label>Skills (comma separated)</label>
<input id="skills">

<label>Projects</label>
<textarea id="projects"></textarea>

<label>Declaration</label>
<textarea id="declaration"></textarea>

<label>Place</label>
<input id="place">

<label>Date</label>
<input id="date" type="date">

<label>Signature</label>
<input id="signature">

<div style="margin-top:15px;">
    <button class="preview-btn" onclick="previewCV()">üëÅ Preview</button>
    <button class="download-btn" onclick="payAndDownload()">üí≥ Pay & Download PDF</button>
</div>
</div>

<!-- Razorpay script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<!-- jsPDF script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
function addAcademic(){
    const d=document.createElement("div");
    d.className="academicRow";
    d.style.display="flex";
    d.style.gap="5px";
    d.innerHTML=`
    <input placeholder="Course">
    <input placeholder="Institute">
    <input placeholder="Year">
    <input placeholder="GPA">
    <button class="remove-btn" onclick="removeAcademic(this)">‚úñ</button>`;
    academicsContainer.appendChild(d);
}

function removeAcademic(btn){btn.parentElement.remove();}

// Preview CV in new window
function previewCV(){
    const f=photo.files[0];
    if(f){
        const r=new FileReader();
        r.onload=e=>openPreview(e.target.result);
        r.readAsDataURL(f);
    }else openPreview("");
}

// Open preview window
function openPreview(photo){
const w=window.open("","_blank","width=900,height=1200");
w.document.write(`
<!DOCTYPE html>
<html>
<head>
<title>Preview</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:Poppins;background:#eee;}
.page{min-height:100vh;background:#fff;margin:20px;padding:30px;border:6px solid;border-image:linear-gradient(45deg,#ff4081,#7c4dff,#00e5ff,#4caf50) 1;}
.header{display:flex;gap:20px}
img{width:120px;height:120px;border-radius:50%}
h2{color:#4caf50}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #aaa;padding:8px;text-align:center}
span{display:inline-block;background:#ff4081;color:#fff;padding:6px 14px;border-radius:30px;margin:4px;}
.close-bar{position:fixed;bottom:0;left:0;width:100%;background:#222;text-align:center;padding:12px;}
.close-bar button{background:#f44336;color:#fff;border:none;border-radius:30px;padding:10px 28px;font-weight:600;cursor:pointer;}
</style>
</head>
<body>

<div class="page">
<div class="header">
${photo?`<img src="${photo}">`:""}
<div>
<h1>${fullName.value}</h1>
<p><b>DOB:</b> ${dob.value}</p>
<p>${email.value} | ${phone.value}</p>
<p>${address.value}</p>
</div>
</div>

<h2>Career Objective</h2><p>${objective.value}</p>
<h2>Professional Summary</h2><p>${summary.value}</p>

<h2>Academics</h2>
<table>
<tr><th>Course</th><th>Institute</th><th>Year</th><th>GPA</th></tr>
${[...document.querySelectorAll(".academicRow")].map(r=>{
let i=r.querySelectorAll("input");
return `<tr><td>${i[0].value}</td><td>${i[1].value}</td><td>${i[2].value}</td><td>${i[3].value}</td></tr>`;
}).join("")}
</table>

<h2>Skills</h2>
${skills.value.split(",").map(s=>`<span>${s.trim()}</span>`).join("")}

<h2>Projects</h2><p>${projects.value}</p>
<h2>Declaration</h2><p>${declaration.value}</p>

<p><b>Place:</b> ${place.value}</p>
<p><b>Date:</b> ${date.value}</p>
<p><b>Signature:</b> ${signature.value}</p>
</div>

<div class="close-bar">
<button onclick="window.close()">‚ùå Close Preview</button>
</div>

</body>
</html>
`);
}

// Razorpay + PDF download
async function payAndDownload(){
    const options = {
        key: "rzp_live_S5ex0BvHGJcmo6", // Razorpay key
        amount: 100, // 100 INR in paise
        currency: "INR",
        name: "Resume Builder",
        description: "Pay to download your resume PDF",
        handler: async function(response){
            alert("Payment Successful ‚úÖ ID: " + response.razorpay_payment_id);
            await generatePDF();
        },
        prefill: {
            name: fullName.value,
            email: email.value,
            contact: phone.value
        },
        theme:{color:"#2196f3"}
    };
    const rzp = new Razorpay(options);
    rzp.open();
}

// Generate PDF using jsPDF
async function generatePDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF('p', 'pt', 'a4');
    
    let y = 40;
    
    // Header
    doc.setFontSize(22);
    doc.text(fullName.value, 40, y);
    y += 25;
    doc.setFontSize(12);
    doc.text(`DOB: ${dob.value} | ${email.value} | ${phone.value}`, 40, y);
    y += 20;
    doc.text(`Address: ${address.value}`, 40, y);
    y += 25;

    // Career Objective
    doc.setFontSize(16);
    doc.text("Career Objective", 40, y);
    y += 18;
    doc.setFontSize(12);
    doc.text(objective.value, 40, y, {maxWidth: 500});
    y += 40;

    // Professional Summary
    doc.setFontSize(16);
    doc.text("Professional Summary", 40, y);
    y += 18;
    doc.setFontSize(12);
    doc.text(summary.value, 40, y, {maxWidth: 500});
    y += 40;

    // Academics Table
    doc.setFontSize(16);
    doc.text("Academics", 40, y);
    y += 20;
    const headers = [["Course","Institute","Year","GPA"]];
    const data = [...document.querySelectorAll(".academicRow")].map(r=>{
        let i = r.querySelectorAll("input");
        return [i[0].value,i[1].value,i[2].value,i[3].value];
    });
    doc.autoTable({ head: headers, body: data, startY: y });
    y = doc.lastAutoTable.finalY + 20;

    // Skills
    doc.setFontSize(16);
    doc.text("Skills", 40, y);
    y += 18;
    doc.setFontSize(12);
    doc.text(skills.value.split(",").map(s=>s.trim()).join(", "), 40, y, {maxWidth:500});
    y += 25;

    // Projects
    doc.setFontSize(16);
    doc.text("Projects", 40, y);
    y += 18;
    doc.setFontSize(12);
    doc.text(projects.value, 40, y, {maxWidth:500});
    y += 25;

    // Declaration
    doc.setFontSize(16);
    doc.text("Declaration", 40, y);
    y += 18;
    doc.setFontSize(12);
    doc.text(declaration.value, 40, y, {maxWidth:500});
    y += 25;

    // Place & Date
    doc.text(`Place: ${place.value}`, 40, y);
    y += 18;
    doc.text(`Date: ${date.value}`, 40, y);
    y += 18;
    doc.text(`Signature: ${signature.value}`, 40, y);

    // Save PDF
    doc.save("Resume.pdf");
}
</script>

<!-- jsPDF AutoTable plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

</body>
</html>
